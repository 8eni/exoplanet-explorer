<script>
	var Model = (function(document) {
  'use strict';

  var exports = {};

  var search = null;

  var utilities = {
    database: [],
    fullLoad: function() {
      // use requestIdleTime?
    },
    fullSearch: function(item) {
      // regex for item in database. if any property hits, return it
    },
    specificSearch: function(property, criteria) {
      // criteria is an object with value, upper, lower
    }
  };
  exports.utilities = utilities;

  function get(url) {
    // Return a new promise.
    return new Promise(function(resolve, reject) {
      // Do the usual XHR stuff
      var req = new XMLHttpRequest();
      req.open('GET', url);

      req.onload = function() {
        // This is called even on 404 etc
        // so check the status
        if (req.status === 200) {
          // Resolve the promise with the response text
          resolve(req.response);
        }
        else {
          // Otherwise reject with the status text
          // which will hopefully be a meaningful error
          reject(Error(req.statusText));
        }
      };

      // Handle network errors
      req.onerror = function() {
        reject(Error('Network Error'));
      };

      // Make the request
      req.send();
    });
  }

  function getJSON(url) {
    return get(url).then(JSON.parse);
  };

  function loadSequence() {
    search = document.querySelector('section[data-route="search"]');
    return getJSON('/data/data.json').then(function(planets) {
        planets.forEach(function(planet) {
          utilities.database.push({name: planet.pl_name, data: planet});
        });
        console.log('loaded model');
        return planets;
      })
  };
  exports.loadSequence = loadSequence;

  window.addEventListener('WebComponentsReady', function() {
    // nothing for now
  });

  return exports;
})(document);

</script>